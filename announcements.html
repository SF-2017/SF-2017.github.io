<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang="announcements_title"></title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* 公告栏页特有样式 */
        .announcement-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 600px; /* 确保内容加载时有固定高度 */
        }
        
        .announcement-item {
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 4px solid var(--primary-color);
        }
        
        .announcement-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .announcement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .announcement-date {
            color: var(--secondary-color);
            font-size: 0.9em;
        }
        
        .announcement-category {
            display: inline-block;
            padding: 3px 10px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }
        
        .page-btn {
            padding: 8px 15px;
            background-color: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--select-border);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .page-btn:hover:not(.active) {
            background-color: var(--select-hover);
        }
        
        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: var(--secondary-color);
        }
    </style>
</head>
<body>
    <header>
        <div class="header-buttons">
            <button id="back-button" data-lang="back_button"></button>
            <div class="controls">
                <button id="theme-toggle">🌙</button>
                <select id="language-selector">
                    <option value="zh-CN">简体中文</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        <h1 data-lang="announcements_title"></h1>
    </header>

    <div class="container">
        <div class="card">
            <div class="loading" data-lang="loading_text">加载中...</div>
            <div class="announcement-list" id="announcement-container">
                <!-- 内容将通过JavaScript动态加载 -->
            </div>
            
            <div class="pagination" id="pagination-container">
                <!-- 分页按钮将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>

    <script src="js/theme.js"></script>
    <script src="js/lang.js"></script>
    <script>
        // 公告数据 - 实际应用中应该从服务器获取
        const allAnnouncements = [
            // 第一页数据
            [
                {
                    id: 1,
                    category: "category_event",
                    title: "announcement1_title",
                    date: "2025-05-17",
                    content: "announcement1_content"
                },
                {
                    id: 2,
                    category: "category_event",
                    title: "announcement2_title",
                    date: "2025-05-16",
                    content: "announcement2_content"
                },
                {
                    id: 3,
                    category: "category_event",
                    title: "announcement3_title",
                    date: "2025-05-15",
                    content: "announcement3_content"
                },
                {
                    id: 4,
                    category: "category_news",
                    title: "announcement4_title",
                    date: "2025-01-01",
                    content: "announcement4_content"
                }
            ],
            // 第二页数据
            [
                {
                    id: 5,
                    category: "category_news",
                    title: "announcement5_title",
                    date: "2025-01-01",
                    content: "announcement5_content"
                },
                {
                    id: 6,
                    category: "category_news",
                    title: "announcement6_title",
                    date: "2025-01-01",
                    content: "announcement6_content"
                },
                {
                    id: 7,
                    category: "category_news",
                    title: "announcement7_title",
                    date: "2025-01-01",
                    content: "announcement7_content"
                },
                {
                    id: 8,
                    category: "category_news",
                    title: "announcement8_title",
                    date: "2025-01-01",
                    content: "announcement8_content"
                }
            ],
            // 第三页数据
            [
                {
                    id: 9,
                    category: "category_news",
                    title: "announcement9_title",
                    date: "2025-01-01",
                    content: "announcement9_content"
                },
                {
                    id: 10,
                    category: "category_news",
                    title: "announcement10_title",
                    date: "2025-01-01",
                    content: "announcement10_content"
                }
            ]
        ];

        // 分页配置
        const paginationConfig = {
            itemsPerPage: 4,      // 每页显示的项目数
            currentPage: 1,       // 当前页码
            totalPages: 0,       // 总页数(将根据数据计算)
            visiblePages: 3       // 可见的分页按钮数
        };

        // DOM元素
        const announcementContainer = document.getElementById('announcement-container');
        const paginationContainer = document.getElementById('pagination-container');
        const loadingElement = document.querySelector('.loading');

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            // 计算总页数
            paginationConfig.totalPages = allAnnouncements.length;
            
            // 加载第一页内容
            loadPage(paginationConfig.currentPage);
            
            // 初始化分页按钮
            renderPagination();
        });

        // 加载指定页面的内容
        function loadPage(pageNumber) {
            // 显示加载指示器
            loadingElement.style.display = 'block';
            announcementContainer.innerHTML = '';
            
            // 模拟网络延迟
            setTimeout(() => {
                // 更新当前页码
                paginationConfig.currentPage = pageNumber;
                
                // 获取当前页的数据
                const currentPageData = allAnnouncements[pageNumber - 1];
                
                // 渲染公告内容
                if (currentPageData && currentPageData.length > 0) {
                    currentPageData.forEach(announcement => {
                        const announcementItem = document.createElement('div');
                        announcementItem.className = 'announcement-item';
                        announcementItem.innerHTML = `
                            <div class="announcement-header">
                                <h3><span class="announcement-category" data-lang="${announcement.category}"></span><span data-lang="${announcement.title}"></span></h3>
                                <span class="announcement-date">${announcement.date}</span>
                            </div>
                            <p data-lang="${announcement.content}"></p>
                            <a href="#" data-lang="read_more"></a>
                        `;
                        announcementContainer.appendChild(announcementItem);
                    });
                    
                    // 加载多语言内容
                    if (window.loadLanguageContent) {
                        window.loadLanguageContent();
                    }
                } else {
                    announcementContainer.innerHTML = '<p data-lang="no_announcements">暂无公告</p>';
                }
                
                // 隐藏加载指示器
                loadingElement.style.display = 'none';
                
                // 重新渲染分页按钮以更新活动状态
                renderPagination();
            }, 500); // 模拟网络延迟
        }

        // 渲染分页按钮
        function renderPagination() {
            paginationContainer.innerHTML = '';
            
            // 上一页按钮
            const prevButton = document.createElement('button');
            prevButton.className = 'page-btn' + (paginationConfig.currentPage === 1 ? ' disabled' : '');
            prevButton.innerHTML = '&larr;';
            prevButton.addEventListener('click', () => {
                if (paginationConfig.currentPage > 1) {
                    loadPage(paginationConfig.currentPage - 1);
                }
            });
            paginationContainer.appendChild(prevButton);
            
            // 页码按钮
            const startPage = Math.max(1, paginationConfig.currentPage - Math.floor(paginationConfig.visiblePages / 2));
            const endPage = Math.min(paginationConfig.totalPages, startPage + paginationConfig.visiblePages - 1);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = 'page-btn' + (i === paginationConfig.currentPage ? ' active' : '');
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => {
                    if (i !== paginationConfig.currentPage) {
                        loadPage(i);
                    }
                });
                paginationContainer.appendChild(pageButton);
            }
            
            // 下一页按钮
            const nextButton = document.createElement('button');
            nextButton.className = 'page-btn' + (paginationConfig.currentPage === paginationConfig.totalPages ? ' disabled' : '');
            nextButton.innerHTML = '&rarr;';
            nextButton.addEventListener('click', () => {
                if (paginationConfig.currentPage < paginationConfig.totalPages) {
                    loadPage(paginationConfig.currentPage + 1);
                }
            });
            paginationContainer.appendChild(nextButton);
        }
    </script>
</body>
</html>