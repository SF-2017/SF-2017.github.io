<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang="announcements_title"></title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* å…¬å‘Šæ é¡µç‰¹æœ‰æ ·å¼ */
        .announcement-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 600px; /* ç¡®ä¿å†…å®¹åŠ è½½æ—¶æœ‰å›ºå®šé«˜åº¦ */
        }
        
        .announcement-item {
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border-left: 4px solid var(--primary-color);
        }
        
        .announcement-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .announcement-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .announcement-date {
            color: var(--secondary-color);
            font-size: 0.9em;
        }
        
        .announcement-category {
            display: inline-block;
            padding: 3px 10px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }
        
        .page-btn {
            padding: 8px 15px;
            background-color: var(--card-bg);
            color: var(--text-color);
            border: 1px solid var(--select-border);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .page-btn:hover:not(.active) {
            background-color: var(--select-hover);
        }
        
        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: var(--secondary-color);
        }
    </style>
</head>
<body>
    <header>
        <div class="header-buttons">
            <button id="back-button" data-lang="back_button"></button>
            <div class="controls">
                <button id="theme-toggle">ğŸŒ™</button>
                <select id="language-selector">
                    <option value="zh-CN">ç®€ä½“ä¸­æ–‡</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        <h1 data-lang="announcements_title"></h1>
    </header>

    <div class="container">
        <div class="card">
            <div class="loading" data-lang="loading_text">åŠ è½½ä¸­...</div>
            <div class="announcement-list" id="announcement-container">
                <!-- å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
            
            <div class="pagination" id="pagination-container">
                <!-- åˆ†é¡µæŒ‰é’®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script src="js/theme.js"></script>
    <script src="js/lang.js"></script>
    <script>
        // å…¬å‘Šæ•°æ® - å®é™…åº”ç”¨ä¸­åº”è¯¥ä»æœåŠ¡å™¨è·å–
        const allAnnouncements = [
            // ç¬¬ä¸€é¡µæ•°æ®
            [
                {
                    id: 1,
                    category: "category_event",
                    title: "announcement1_title",
                    date: "2025-05-17",
                    content: "announcement1_content"
                },
                {
                    id: 2,
                    category: "category_event",
                    title: "announcement2_title",
                    date: "2025-05-16",
                    content: "announcement2_content"
                },
                {
                    id: 3,
                    category: "category_event",
                    title: "announcement3_title",
                    date: "2025-05-15",
                    content: "announcement3_content"
                },
                {
                    id: 4,
                    category: "category_news",
                    title: "announcement4_title",
                    date: "2025-01-01",
                    content: "announcement4_content"
                }
            ],
            // ç¬¬äºŒé¡µæ•°æ®
            [
                {
                    id: 5,
                    category: "category_news",
                    title: "announcement5_title",
                    date: "2025-01-01",
                    content: "announcement5_content"
                },
                {
                    id: 6,
                    category: "category_news",
                    title: "announcement6_title",
                    date: "2025-01-01",
                    content: "announcement6_content"
                },
                {
                    id: 7,
                    category: "category_news",
                    title: "announcement7_title",
                    date: "2025-01-01",
                    content: "announcement7_content"
                },
                {
                    id: 8,
                    category: "category_news",
                    title: "announcement8_title",
                    date: "2025-01-01",
                    content: "announcement8_content"
                }
            ],
            // ç¬¬ä¸‰é¡µæ•°æ®
            [
                {
                    id: 9,
                    category: "category_news",
                    title: "announcement9_title",
                    date: "2025-01-01",
                    content: "announcement9_content"
                },
                {
                    id: 10,
                    category: "category_news",
                    title: "announcement10_title",
                    date: "2025-01-01",
                    content: "announcement10_content"
                }
            ]
        ];

        // åˆ†é¡µé…ç½®
        const paginationConfig = {
            itemsPerPage: 4,      // æ¯é¡µæ˜¾ç¤ºçš„é¡¹ç›®æ•°
            currentPage: 1,       // å½“å‰é¡µç 
            totalPages: 0,       // æ€»é¡µæ•°(å°†æ ¹æ®æ•°æ®è®¡ç®—)
            visiblePages: 3       // å¯è§çš„åˆ†é¡µæŒ‰é’®æ•°
        };

        // DOMå…ƒç´ 
        const announcementContainer = document.getElementById('announcement-container');
        const paginationContainer = document.getElementById('pagination-container');
        const loadingElement = document.querySelector('.loading');

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            // è®¡ç®—æ€»é¡µæ•°
            paginationConfig.totalPages = allAnnouncements.length;
            
            // åŠ è½½ç¬¬ä¸€é¡µå†…å®¹
            loadPage(paginationConfig.currentPage);
            
            // åˆå§‹åŒ–åˆ†é¡µæŒ‰é’®
            renderPagination();
        });

        // åŠ è½½æŒ‡å®šé¡µé¢çš„å†…å®¹
        function loadPage(pageNumber) {
            // æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨
            loadingElement.style.display = 'block';
            announcementContainer.innerHTML = '';
            
            // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            setTimeout(() => {
                // æ›´æ–°å½“å‰é¡µç 
                paginationConfig.currentPage = pageNumber;
                
                // è·å–å½“å‰é¡µçš„æ•°æ®
                const currentPageData = allAnnouncements[pageNumber - 1];
                
                // æ¸²æŸ“å…¬å‘Šå†…å®¹
                if (currentPageData && currentPageData.length > 0) {
                    currentPageData.forEach(announcement => {
                        const announcementItem = document.createElement('div');
                        announcementItem.className = 'announcement-item';
                        announcementItem.innerHTML = `
                            <div class="announcement-header">
                                <h3><span class="announcement-category" data-lang="${announcement.category}"></span><span data-lang="${announcement.title}"></span></h3>
                                <span class="announcement-date">${announcement.date}</span>
                            </div>
                            <p data-lang="${announcement.content}"></p>
                            <a href="#" data-lang="read_more"></a>
                        `;
                        announcementContainer.appendChild(announcementItem);
                    });
                    
                    // åŠ è½½å¤šè¯­è¨€å†…å®¹
                    if (window.loadLanguageContent) {
                        window.loadLanguageContent();
                    }
                } else {
                    announcementContainer.innerHTML = '<p data-lang="no_announcements">æš‚æ— å…¬å‘Š</p>';
                }
                
                // éšè—åŠ è½½æŒ‡ç¤ºå™¨
                loadingElement.style.display = 'none';
                
                // é‡æ–°æ¸²æŸ“åˆ†é¡µæŒ‰é’®ä»¥æ›´æ–°æ´»åŠ¨çŠ¶æ€
                renderPagination();
            }, 500); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
        }

        // æ¸²æŸ“åˆ†é¡µæŒ‰é’®
        function renderPagination() {
            paginationContainer.innerHTML = '';
            
            // ä¸Šä¸€é¡µæŒ‰é’®
            const prevButton = document.createElement('button');
            prevButton.className = 'page-btn' + (paginationConfig.currentPage === 1 ? ' disabled' : '');
            prevButton.innerHTML = '&larr;';
            prevButton.addEventListener('click', () => {
                if (paginationConfig.currentPage > 1) {
                    loadPage(paginationConfig.currentPage - 1);
                }
            });
            paginationContainer.appendChild(prevButton);
            
            // é¡µç æŒ‰é’®
            const startPage = Math.max(1, paginationConfig.currentPage - Math.floor(paginationConfig.visiblePages / 2));
            const endPage = Math.min(paginationConfig.totalPages, startPage + paginationConfig.visiblePages - 1);
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = 'page-btn' + (i === paginationConfig.currentPage ? ' active' : '');
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => {
                    if (i !== paginationConfig.currentPage) {
                        loadPage(i);
                    }
                });
                paginationContainer.appendChild(pageButton);
            }
            
            // ä¸‹ä¸€é¡µæŒ‰é’®
            const nextButton = document.createElement('button');
            nextButton.className = 'page-btn' + (paginationConfig.currentPage === paginationConfig.totalPages ? ' disabled' : '');
            nextButton.innerHTML = '&rarr;';
            nextButton.addEventListener('click', () => {
                if (paginationConfig.currentPage < paginationConfig.totalPages) {
                    loadPage(paginationConfig.currentPage + 1);
                }
            });
            paginationContainer.appendChild(nextButton);
        }
    </script>
</body>
</html>